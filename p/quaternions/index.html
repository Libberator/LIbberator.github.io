<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Do quaternions have your head spinning? What are they? How do you use them?"><title>Your Guide to Quaternions</title>
<link rel=canonical href=https://libberator.github.io/p/quaternions/><link rel=stylesheet href=/scss/style.min.0b09cebab997fe7c2f218608ca67eebcb124c2cb3ffa0dda700f3a91bb63fb9d.css><meta property='og:title' content="Your Guide to Quaternions"><meta property='og:description' content="Do quaternions have your head spinning? What are they? How do you use them?"><meta property='og:url' content='https://libberator.github.io/p/quaternions/'><meta property='og:site_name' content="Libbs' Lab"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='math'><meta property='article:tag' content='c#'><meta property='article:tag' content='unity'><meta property='article:published_time' content='2023-07-04T12:00:00-07:00'><meta property='article:modified_time' content='2023-07-04T12:00:00-07:00'><meta property='og:image' content='https://hugelolcdn.com/hugewoah.com/i/7950.gif'><meta name=twitter:title content="Your Guide to Quaternions"><meta name=twitter:description content="Do quaternions have your head spinning? What are they? How do you use them?"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://hugelolcdn.com/hugewoah.com/i/7950.gif'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu3cfe8d3c60fa76028769e4b4ebe85739_38220_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Libbs' Lab</a></h1><h2 class=site-description>Programmer, Gamedev, Math Nerd</h2></div></header><ol class=menu-social><li><a href=https://github.com/Libberator target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Articles</span></a></li><li><a href=/games/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="6" x2="10" y1="11" y2="11"/><line x1="8" x2="8" y1="9" y2="13"/><line x1="15" x2="15.01" y1="12" y2="12"/><line x1="18" x2="18.01" y1="10" y2="10"/><path d="M17.32 5H6.68A4 4 0 002.702 8.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 003 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 019.828 16h4.344a2 2 0 011.414.586L17 18c.5.5 1 1 2 1a3 3 0 003-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0017.32 5z"/></svg>
<span>Games</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About Me</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#intro>Intro</a><ol><li><a href=#terminology>Terminology</a></li></ol></li><li><a href=#intuition>Intuition</a><ol><li><a href=#frame-of-reference>Frame of Reference</a></li><li><a href=#axis-and-angles>Axis and Angles</a></li><li><a href=#why-euler-angles-suck>Why Euler Angles Suck</a></li></ol></li><li><a href=#properties-of-quaternions>Properties of Quaternions</a><ol><li><a href=#unit-quaternions-normalized>Unit Quaternions (Normalized)</a></li><li><a href=#identity-1>Identity (&ldquo;1&rdquo;)</a></li><li><a href=#invertability-ctrl--z>Invertability (Ctrl + Z)</a></li><li><a href=#associativity-parentheses-order-doesnt-matter>Associativity (Parentheses order doesn&rsquo;t matter)</a></li><li><a href=#non-commutativity-multiplcation-order-matters>Non-Commutativity (Multiplcation order matters)</a></li><li><a href=#a-complete-rotation-is-720-not-just-360>A &ldquo;Complete&rdquo; Rotation is 720°, Not Just 360°</a></li></ol></li><li><a href=#unity-methods>Unity Methods</a><ol><li><a href=#quaternion-creation>Quaternion Creation</a></li><li><a href=#quaternion-interpolation>Quaternion Interpolation</a><ol><li><a href=#time--or-percent-based-methods>Time- or Percent-Based Methods</a></li><li><a href=#speed-based-method>Speed-Based Method</a></li></ol></li><li><a href=#transform-options-for-rotating>Transform Options for Rotating</a></li><li><a href=#quaternion-methods-youll-never-or-rarely-use>Quaternion Methods You&rsquo;ll Never or Rarely Use</a></li></ol></li><li><a href=#math>Math</a><ol><li><a href=#geometric-interpretation>Geometric Interpretation</a></li><li><a href=#imaginary-numbers>Imaginary Numbers</a></li><li><a href=#the-real-part-w>The Real Part: w</a></li><li><a href=#from-axis--angle-to-quaternion>From Axis & Angle to Quaternion</a></li><li><a href=#from-quaternion-to-axis--angle>From Quaternion to Axis & Angle</a></li><li><a href=#qq-multiplication>Q*Q Multiplication</a></li><li><a href=#qv-multiplication>Q*V Multiplication</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#bonus-material-and-resources>Bonus Material and Resources</a><ol><li><a href=#faq>FAQ</a></li><li><a href=#videos>Videos</a></li><li><a href=#reading>Reading</a></li><li><a href=#further-reading>Further Reading</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/quaternions/><img src=https://hugelolcdn.com/hugewoah.com/i/7950.gif loading=lazy alt="Featured image of post Your Guide to Quaternions"></a></div><div class=article-details><header class=article-category><a href=/categories/blogging/>Blogging</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/quaternions/>Your Guide to Quaternions</a></h2><h3 class=article-subtitle>Do quaternions have your head spinning? What are they? How do you use them?</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 04, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>25 minute read</time></div></footer></div></header><section class=article-content><blockquote><center><i>Here as he walked by on the 16th of October 1843 Sir William Rowan Hamilton<br>in a flash of genius discovered the fundamental formula for quaternion multiplication:<br><code>i<sup>2</sup> = j<sup>2</sup> = k<sup>2</sup> = ijk = -1</code></i><br>—Plaque on Broom Bridge, Dublin</center></blockquote><h2 id=intro><a href=#intro>#</a>
Intro</h2><p>So you want to learn about quaternions? Well, you&rsquo;ve come to the right place. I&rsquo;ll try my best to simplify it for you. This is written assuming that you know the following:</p><ul><li>Vectors and/or Vector math fundamentals,</li><li>the difference between &ldquo;global&rdquo; and &ldquo;local&rdquo;, or the term &ldquo;relative to&rdquo;</li></ul><p>I&rsquo;ve split this article into four main parts:</p><ol><li><strong><a class=link href=#intuition>Intuition</a></strong>. How to think about them</li><li><strong><a class=link href=#properties-of-quaternions>Properties of Quaternions</a></strong></li><li><strong><a class=link href=#unity-methods>Unity Methods</a></strong> and alternative rotational options</li><li>Deeper dive into the <strong><a class=link href=#math>Math</a></strong> behind them</li></ol><h3 id=terminology><a href=#terminology>#</a>
Terminology</h3><p>You probably know already that a quaternion represents a &ldquo;rotation&rdquo;. Great! (<em>Technically</em>, they can be used for other things like scale, but not for our purposes. I digress&mldr;) However, the term &ldquo;rotation&rdquo; is a bit overloaded, so to clarify the terminology I&rsquo;ll be splitting it into two distinct terms (Note: these are not &ldquo;official&rdquo; or universally standardized terms):</p><ul><li><u>Orientation</u>: the <strong>state</strong> or <strong>pose</strong> of an object. How the object is <del>positioned</del>/oriented in space.</li><li><u>Rotation</u>: the <strong>action</strong> or <strong>verb</strong> of rotating/turning/spinning an object. Specifically denotes the transformation or struct that will be <em>applied</em> to another <strong>rotation <em>or</em> orientation</strong>.</li></ul><details><summary><b>Example Terminology Usage</b></summary>Consider an object initially facing East. "Facing East" represents an orientation. To make the object face South, we need to apply a rotation. If we say "turn 90° about the Y axis", this describes a rotation without explicitly mentioning the resulting orientation. It's like giving driving directions to a computer.</details><br><p>When you see or hear &ldquo;multiplying&rdquo; (in the context of quaternions), it&rsquo;s easier to instead think of &ldquo;applying&rdquo; - not in the sense of &ldquo;setting&rdquo; but rather &ldquo;modifying by&rdquo;. Multiplying a quaternion with a vector means you&rsquo;re <strong>applying</strong> the rotation <em>to</em> the vector. If you&rsquo;ve ever heard someone say <em>&ldquo;multiplying quaternions together is like adding them&rdquo;</em>, <strong>unlearn that</strong>. We don&rsquo;t &ldquo;add&rdquo; quaternions in the traditional sense. Instead, one rotation gets <em>applied</em> to the other. It&rsquo;s better in the long-run to think about them properly rather than lazily.</p><p>Also worth mentioning&mldr;</p><ul><li>I will be using Unity&rsquo;s coordinate system (X = right, Y = up, Z = forward), which is a Left-Handed coordinate system (i.e. satisfies Left-Hand Rule). If you don&rsquo;t know what that means, look it up. In short: positive angles are CCW rotations when looking in the same direction of the axis you&rsquo;re rotating about.</li></ul><h2 id=intuition><a href=#intuition>#</a>
Intuition</h2><h3 id=frame-of-reference><a href=#frame-of-reference>#</a>
Frame of Reference</h3><p>Are you looking to perform a <em>relative</em> rotation or a <em>global</em> one? Just like how a vector can represent either a global or local position, a quaternion struct can be global or local - it matters how you set them up and use them. Without any context, you can consider all quaternions to be global because you have nothing else to reference the rotation on. However, if you set up a quaternion using a relative value and apply it to the same object, that makes it a relative rotation. For instance, using <code>transform.forward</code> would make the rotation relative to the object&rsquo;s <code>Transform</code>, while <code>Vector3.forward</code> represents a global rotation.</p><p>It&rsquo;s generally not a good idea to try to share relative rotations with another object, especially if they started with a different orientation.</p><p>Don&rsquo;t confuse <code>transform.rotation</code> and <code>transform.localRotation</code>. Know the difference.<br>Are you calculating a global orientation relative to the global XYZ coordinates (e.g. wanting to make your character face a target), then use the global-facing <code>transform.rotation</code>. If you only care about how it rotates with respect to its parent (e.g. Animations, door swinging on a hinge), then use <code>transform.localRotation</code>.</p><p>Bonus Tip: In Unity, toggle between &ldquo;Local&rdquo; and &ldquo;Global&rdquo; to see which axis is which on the Gizmo. Extra useful if you imported a model and the axes are set up differently.</p><h3 id=axis-and-angles><a href=#axis-and-angles>#</a>
Axis and Angles</h3><p>Look around yourself at all the things that do any kind of rotating. And I want you to think in terms of <strong>Axis</strong> and <strong>Angles</strong>. That&rsquo;s a singular axis: a vector in *any* direction of your choice. This axis will be what gets rotated <em>around</em> by a certain amount of angular units. I&rsquo;ll be using degrees, but radians are valid too.</p><p>Leaning back in your chair? Nah. You&rsquo;re rotating the chair negative degrees about its <code>right</code> axis (or positive degrees about the <code>left</code> axis).</p><p>Looking down and to your left? Nah. Your neck is oriented some positive degrees around <code>Vector(1, -1, 0)</code>, assuming Z is your forward. Might be tough to wrap your head around.</p><p>Grab a pineapple. &#x1f34d; Grab a pen. &#x1f58a;&#xfe0f; Make a Pineapple Pen. &#x1f34d; &#x1f58a;&#xfe0f; That pen is the axis, at whatever arbitrary vector you stuck it in at. Spin it to see how it rotates.</p><p>Why think in terms of axis and angles? Because that&rsquo;s more in line with how quaternions actually rotate. If you have a start and end orientation and want to interpolate between them, the shortest path is achieved with this kind of visualization. It&rsquo;s like drawing two dots on a basketball and connecting it with the shortest line. Look at the path the dot needs to travel, and rotate it with an axis that&rsquo;s perpendicular to that.</p><h3 id=why-euler-angles-suck><a href=#why-euler-angles-suck>#</a>
Why Euler Angles Suck</h3><p><em>Disclaimer: These reasons don&rsquo;t really apply to standard 2D games, because you usually only rotate thing about a single Z axis. So it&rsquo;s typically fine to use Euler Angles there.</em></p><details><summary>What are Euler Angles?</summary>It's a combination of 3 numbers representing the amount of angles rotated about each axes (X, Y, and Z), with a total range of 360° each. This is what you're used to using and seeing and what's displayed in Unity's Inspector for a Transform's "Rotation".</details><p> <b>#1. You can&rsquo;t always trust the numbers you see in the Inspector</b></p><p>Those numbers next to &ldquo;Rotation&rdquo; aren&rsquo;t even its <code>transform.rotation</code>, but rather the Transform&rsquo;s <strong>local orientation</strong> (i.e. relative to its parent). The Inspector lies to you, so don&rsquo;t be fooled.</p><p>Despite displaying as Euler angles, they&rsquo;re actually a Quaternion behind the scenes. If you rotate around multiple axes, like for some 3D games, don&rsquo;t use its Euler angles as a reference to base your logic off of. This is because the internal conversion that Unity does between Quaternions and Euler angles can have some of the angles &ldquo;jumping around&rdquo;, giving you <strong>unpredictable</strong> and <strong>unreliable</strong> behavior.</p><p> <b>#2. Euler Angles are subject to Gimbal Lock</b></p><p>&ldquo;What even is that?&rdquo; you might be thinking. Let me Google that for you: &ldquo;Gimbal Lock happens when two of the rotational axes align, causing a loss of one degree of freedom.&rdquo; Okay, that wasn&rsquo;t very helpful.</p><p>But it&rsquo;s fairly easy to demonstrate with an actual example, so let&rsquo;s do a &ldquo;show, don&rsquo;t tell&rdquo; approach here. Put the following script on a GameObject:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>GimbalLockExample</span> <span class=p>:</span> <span class=n>MonoBehaviour</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=na>    [SerializeField]</span> <span class=kd>private</span> <span class=kt>float</span> <span class=n>_speed</span> <span class=p>=</span> <span class=m>50f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>float</span> <span class=n>_pitch</span><span class=p>,</span> <span class=n>_yaw</span><span class=p>,</span> <span class=n>_roll</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>void</span> <span class=n>Update</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>pitchInput</span> <span class=p>=</span> <span class=n>Input</span><span class=p>.</span><span class=n>GetAxisRaw</span><span class=p>(</span><span class=s>&#34;Vertical&#34;</span><span class=p>);</span> <span class=c1>// W/S</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>yawInput</span> <span class=p>=</span> <span class=n>Input</span><span class=p>.</span><span class=n>GetAxisRaw</span><span class=p>(</span><span class=s>&#34;Horizontal&#34;</span><span class=p>);</span> <span class=c1>// A/D</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>rollInput</span> <span class=p>=</span> <span class=p>(</span><span class=n>Input</span><span class=p>.</span><span class=n>GetKey</span><span class=p>(</span><span class=n>KeyCode</span><span class=p>.</span><span class=n>Q</span><span class=p>)</span> <span class=p>?</span> <span class=m>1f</span> <span class=p>:</span> <span class=m>0f</span><span class=p>)</span> <span class=p>+</span> 
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=n>Input</span><span class=p>.</span><span class=n>GetKey</span><span class=p>(</span><span class=n>KeyCode</span><span class=p>.</span><span class=n>E</span><span class=p>)</span> <span class=p>?</span> <span class=p>-</span><span class=m>1f</span> <span class=p>:</span> <span class=m>0f</span><span class=p>);</span> <span class=c1>// Q/E</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>_pitch</span> <span class=p>+=</span> <span class=n>pitchInput</span> <span class=p>*</span> <span class=n>_speed</span> <span class=p>*</span> <span class=n>Time</span><span class=p>.</span><span class=n>deltaTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>_yaw</span> <span class=p>+=</span> <span class=n>yawInput</span> <span class=p>*</span> <span class=n>_speed</span> <span class=p>*</span> <span class=n>Time</span><span class=p>.</span><span class=n>deltaTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>_roll</span> <span class=p>+=</span> <span class=n>rollInput</span> <span class=p>*</span> <span class=n>_speed</span> <span class=p>*</span> <span class=n>Time</span><span class=p>.</span><span class=n>deltaTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>transform</span><span class=p>.</span><span class=n>rotation</span> <span class=p>=</span> <span class=n>Quaternion</span><span class=p>.</span><span class=n>Euler</span><span class=p>(</span><span class=n>_pitch</span><span class=p>,</span> <span class=n>_yaw</span><span class=p>,</span> <span class=n>_roll</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Press &lsquo;S&rsquo; until you&rsquo;ve pitched upwards 90° (&ldquo;inverted controls&rdquo; are just for this demo; I&rsquo;m not a monster) so that the local forward vector aligns with the global Y-axis - this is when the red and blue rings align in the video below (at 0:10). Then you&rsquo;ll see that any adjustment to Yaw (A/D) or Roll (Q/E) will be <strong>indistinguishable</strong> from one another; they both behave like Roll. That&rsquo;s a loss of a degree of freedom (a.k.a. &ldquo;gimbal lock&rdquo;).</p><div class=video-wrapper><video controls src=gimbal-lock.webm autoplay><p>Your browser doesn't support HTML5 video. Here is a
<a href=gimbal-lock.webm>link to the video</a> instead.</p></video></div><center><u><b><a href=../../g/gimbal-lock target=_blank>Play this Gimbal Lock demo for yourself!</a></b></u></center><p> <b>#3. Interpolation sucks</b></p><p>At the end of the <strong><a class=link href=#axis-and-angles>Axis and Angles</a></strong> section, I pointed out that quaternions will interpolate along the shortest path. If you interpolate with Euler angles, well&mldr; it&rsquo;s not a straight path. It will be more like a soft &ldquo;S&rdquo;. Or it will just glitch out the rotation entirely, because Lerping one axis from 359° to 0° <em>doesn&rsquo;t</em> move just 1° like you&rsquo;d hope it would.*</p><p><em>*This example assumes you&rsquo;re manually handling the Lerping of Euler angles, and not using built-in Quaternion methods.</em></p><p> <b>#4. Dealing with the wrap-around point sucks</b></p><p>Having to add extra code to handle the transition between 0° and 360° (or -180° and 180°) to complete the circle is tedious. This is a situational game-dependent opinion, and sometimes unavoidable, but it&rsquo;s still a pain. Clamping how far up and down you can look in an FPS is fine. But managing Eulers for handling Yaw in a Top-Down/3rd Person game feels wrong to me.</p><h2 id=properties-of-quaternions><a href=#properties-of-quaternions>#</a>
Properties of Quaternions</h2><h3 id=unit-quaternions-normalized><a href=#unit-quaternions-normalized>#</a>
Unit Quaternions (Normalized)</h3><p>Unit quaternions have a ||magnitude|| of 1. This means if you square all four components and add them together, it should equal 1. Techincally should square-root it too, but $\sqrt{1} = 1$, so I&rsquo;m cutting corners. Within Unity, quaternions get normalized by default. There does exist a <code>Normalize</code> method in case you&rsquo;re manually entering quaternion values and it, for some reason, doesn&rsquo;t auto-normalize (it can happen). But usually you shouldn&rsquo;t have to worry about that. Non-Unit Quaternions are more complicated things that I&rsquo;m just not going to get into.</p><h3 id=identity-1><a href=#identity-1>#</a>
Identity (&ldquo;1&rdquo;)</h3><p>Identity just means &ldquo;no change&rdquo;. It&rsquo;s like multiplying regular numbers by <code>1</code>, or adding <code>0</code>. When you set an object&rsquo;s orientation to <code>Quaternion.identity</code>, it goes to the default orientation, which represents an absence of any rotations applied (i.e. 0° on all Euler Angles).</p><p><code>Q<sub>I</sub> = new Quaternion(0, 0, 0, 1);</code></p><h3 id=invertability-ctrl--z><a href=#invertability-ctrl--z>#</a>
Invertability (Ctrl + Z)</h3><p>The Inverse of a quaternion <code>Q</code> is denoted as <code>Q<sup>-1</sup></code>. Any rotation that is applied can be undone. A quaternion will cancel out with its Inverse, resulting in the Identity quaternion. Thinking in terms of <em>Axis and Angles</em>, you can view it as negating the axis to point in the opposite direction, while keeping the same rotational angle. Another way to think about it is just negating the angle to rotate in the opposite direction. Mathematically speaking:</p><p><code>Q<sup>-1</sup> = new Quaternion(-Q.x, -Q.y, -Q.z, Q.w);</code></p><p><code>Q * Q<sup>-1</sup> = Q<sup>-1</sup> * Q = Q<sub>I</sub></code> (Identity)</p><p>Note: There also exists a quaternion Conjugate, <code>Q<sup>*</sup></code>, where the only difference is that Conjugate keeps the original magnitude and the Inverse is just the Conjugate divided by the square-magnitude. But since we&rsquo;re working with Unit quaternions, the Inverse and Conjugate will be the same for our purposes, so I purposefully omitted any division operation for the Inverse.</p><h3 id=associativity-parentheses-order-doesnt-matter><a href=#associativity-parentheses-order-doesnt-matter>#</a>
Associativity (Parentheses order doesn&rsquo;t matter)</h3><p>Given quaternions <code>Q<sub>1</sub></code>, <code>Q<sub>2</sub></code>, and <code>Q<sub>3</sub></code>, associativity states that:</p><p><code>(Q<sub>1</sub> * Q<sub>2</sub>) * Q<sub>3</sub> = Q<sub>1</sub> * (Q<sub>2</sub> * Q<sub>3</sub>)</code></p><p>Same applies when multiplying with a vector <code>V</code>:</p><p><code>(Q<sub>1</sub> * Q<sub>2</sub>) * V = Q<sub>1</sub> * (Q<sub>2</sub> * V)</code></p><h3 id=non-commutativity-multiplcation-order-matters><a href=#non-commutativity-multiplcation-order-matters>#</a>
Non-Commutativity (Multiplcation order matters)</h3><p>Given quaternions <code>Q<sub>1</sub></code> and <code>Q<sub>2</sub></code>, non-commutativity states that:</p><p><code>Q<sub>1</sub> * Q<sub>2</sub></code> is <strong>not always</strong> the same as <code>Q<sub>2</sub> * Q<sub>1</sub></code></p><p>There are <em>some cases</em> where they will just happen to be equal. Like if at least one of them is the Identity quaternion, if one is the Inverse of the other, or some other exceptions involving symmetry.</p><p>When multiplying quaternions together, the best way to think about it is from <strong>right-to-left</strong> (I know, it seems backwards). Given <code>Q<sub>1</sub> * Q<sub>2</sub> * V</code>: start with the Vector direction, imagine rotating it <em>first</em> by <code>Q<sub>2</sub></code>, <em>then</em> rotate that resulting vector by <code>Q<sub>1</sub></code>. Order of operations is important to visualize the rotations. Alternatively, if you prefer left-to-right, you could try to visualize the result of <code>Q<sub>1</sub> * Q<sub>2</sub></code> first, but I find that&rsquo;s generally harder.</p><h3 id=a-complete-rotation-is-720-not-just-360><a href=#a-complete-rotation-is-720-not-just-360>#</a>
A &ldquo;Complete&rdquo; Rotation is 720°, Not Just 360°</h3><div class=video-wrapper><video controls src=quaternion-spin.webm autoplay><p>Your browser doesn't support HTML5 video. Here is a
<a href=quaternion-spin.webm>link to the video</a> instead.</p></video></div><p>By &ldquo;complete&rdquo;, I&rsquo;m referring to an orientation returning to its starting <em>state</em>. If you track one face of the cube in the video (or gif at the top), you&rsquo;ll see how this works where there are two different &ldquo;states&rdquo; even when the face of the cube is oriented the same way.</p><p>This is how it works in real life, too: Electrons and other matter particles in quantum mechanics have this property called &ldquo;spin&rdquo;. These two similar-but-different states are what physicists are referring to when they say &ldquo;spin up&rdquo; or &ldquo;spin down&rdquo;.</p><h2 id=unity-methods><a href=#unity-methods>#</a>
Unity Methods</h2><h3 id=quaternion-creation><a href=#quaternion-creation>#</a>
Quaternion Creation</h3><ul><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.Euler.html target=_blank rel=noopener>Euler</a>: Rotation that rotates z° around the <code>z</code> axis, x° around the <code>x</code> axis, and y° around the <code>y</code> axis. <strong>In that order</strong><ul><li>Can access these values with <code>transform.eulerAngles</code> - not to be confused with <code>transform.rotation</code></li><li>If you&rsquo;re typically setting two of the three values to <code>0°</code>, you can accomplish the same thing with AngleAxis instead</li></ul></li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.AngleAxis.html target=_blank rel=noopener>AngleAxis</a>: Are you thinking in terms of axis and angles yet?<ul><li>You can create most of the same quaternions you&rsquo;d probably make with Euler with this instead</li><li>This method is <em><strong>FASTER</strong></em>, too! With a simple test of 100,000 calls every frame, AngleAxis outperformed Euler with 30-50% more FPS. Ditch using Euler; it&rsquo;s a more expensive operation</li></ul></li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.LookRotation.html target=_blank rel=noopener>LookRotation</a>: Get an orientation by providing a <code>Vector3 forward</code> and a <code>Vector3 upwards</code>. The upwards vector (default: <code>Vector3.up</code>) is used as a &ldquo;hint&rdquo; to determine how to orient the Roll<ul><li>Usually you&rsquo;ll get a forward direction by doing <code>target.position - transform.position</code></li><li>Make sure your forward vector won&rsquo;t directly align with the upward vector. Provide a new upward hint if that will be a problem</li><li><details><summary>Example Analogy</summary>You know how dogs do that cute little head-tilt when they're confused? Their eyes are still locked onto their target (you, probably after saying "treat" or "walk" to pique their interest) looking "forward". But their head's "up" reference is changing, no longer aligned with <code>Vector3.up</code></details></li></ul></li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.FromToRotation.html target=_blank rel=noopener>FromToRotation</a>: This gets the difference in orientation between two direction vectors; the <em>rotation</em> that you would need to apply to <code>fromDirection</code> which will result in the <code>toDirection</code>.<ul><li>In other words, this solves for <code>Q<sub>FromTo</sub></code> in the equation <code>Q<sub>FromTo</sub> * V<sub>From</sub> = V<sub>To</sub></code></li><li>This method was vital for my Roll-a-Tetrahedron solution</li></ul></li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.Inverse.html target=_blank rel=noopener>Inverse</a>: Gets the <del>evil twin</del> opposite rotation of a quaternion.<ul><li>Example: if you wanted to get <code>Q<sub>ToFrom</sub></code>, you <em>could</em> call FromToRotation again swapping parameters or you could just do <code>Q<sub>ToFrom</sub> = Quaternion.Inverse(Q<sub>FromTo</sub>);</code></li></ul></li><li>The <a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion-ctor.html target=_blank rel=noopener>Quaternion Constructor</a>: this takes in 4 floats <code>x</code>,<code>y</code>,<code>z</code>, and <code>w</code>. You usually won&rsquo;t use this. If you are using this, it&rsquo;s for one of the following reasons:<ul><li>deserialization</li><li>optimizations (e.g. swizzling via extension methods)</li><li>you understand quaternions better than most</li><li>you copied code you found somewhere</li></ul></li></ul><h3 id=quaternion-interpolation><a href=#quaternion-interpolation>#</a>
Quaternion Interpolation</h3><p>When interpolating between a start and end orientation, Quaternions take the shortest path (this means that angles more than 180° apart aren&rsquo;t a thing). Try to avoid having your start and end 180° apart (pointing in opposite directions), otherwise the path between them will not be well-defined.</p><h4 id=time--or-percent-based-methods><a href=#time--or-percent-based-methods>#</a>
Time- or Percent-Based Methods</h4><ul><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.Lerp.html target=_blank rel=noopener>Lerp</a>: Linear interpolation between [0-1]</li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.Slerp.html target=_blank rel=noopener>Slerp</a>: Spherical interpolation between [0-1]</li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.LerpUnclamped.html target=_blank rel=noopener>LerpUnclamped</a> & <a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.SlerpUnclamped.html target=_blank rel=noopener>SlerpUnclamped</a>: can also extrapolate beyond 0 and 1</li></ul><details><summary>What's the difference between Lerp and Slerp? Aren't they both spherical since it involves things that rotate?</summary>Yeah, not much difference tbh. Unlike the differences between Vector3's Lerp and Slerp, these all follow the same path but just have an ever-so-slightly different easing/timing along the path. The docs say that "[Lerp] is faster than Slerp but looks worse if the rotations are far apart." But it's hard to see a difference</details><details><summary>Do LerpUnclamped and SlerpUnclamped behave the same?</summary><b>No</b>. Because of how the math works with extrapolating and quaternions getting auto-normalized, LerpUnclamped "fizzles out" at certain values outside the 0-1 range, like diminishing returns. Unsatisfying.<br>In my tests, if the angle between the start and end orientations are less than ~36° apart, then SlerpUnclamped <i>also</i> behaves like LerpUnclamped. However, at larger starting angles, SlerpUnclamped shines and will properly extrapolate.<br>For example, if you wanted to extrapolate the Minute Hand on a Clock, your start and end orientations should be at least 6 minutes apart, but less than 30 minutes so that <i>forward</i> in time doesn't go the wrong way</details><h4 id=speed-based-method><a href=#speed-based-method>#</a>
Speed-Based Method</h4><ul><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.RotateTowards.html target=_blank rel=noopener>RotateTowards</a>: Get an orientation that is the <code>from</code> quaternion rotated by a <code>float maxDegreesDelta</code> angle towards the <code>to</code> quaternion without overshooting<ul><li>If you use a <code>float rotationSpeed</code> multiplied by <code>Time.deltaTime</code>, it will rotate at that <strong>rate</strong> in degrees per second, no matter the difference between <code>from</code> and <code>to</code></li></ul></li></ul><h3 id=transform-options-for-rotating><a href=#transform-options-for-rotating>#</a>
Transform Options for Rotating</h3><p>Quaternions by theirself are just a math construct - they have no idea what a Transform is. With the Transform class, you have access to more contextual utility, like methods that know the difference between global and local.</p><ul><li><a class=link href=https://docs.unity3d.com/ScriptReference/Transform.Rotate.html target=_blank rel=noopener>Transform.Rotate</a>: This method has many overlaod options<ul><li>Primarily relies on Euler Angles or an Axis and Angle combo</li><li>Can specify whether it&rsquo;s a global (<code>Space.World</code>) or local (<code>Space.Self</code>) rotation (default)</li></ul></li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Transform.RotateAround.html target=_blank rel=noopener>Transform.RotateAround</a>: Like a satellite orbiting around a planet or like a hinge joint, this method <strong>also affects the position</strong><ul><li>Uses an Axis and Angle and a world position <code>Vector3 point</code> as a pivot or anchor that the axis passes through</li></ul></li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Transform.LookAt.html target=_blank rel=noopener>Transform.LookAt</a>: Immediately snap a transform&rsquo;s forward to a <code>Transform target</code> or <code>Vector3 worldPosition</code><ul><li>Similar to <code>Quaternion.LookRotation</code>, this also can take a <code>Vector3 worldUp</code> hint</li><li>For 2D games, since this defaults to using the transform&rsquo;s forward, you&rsquo;ll either want to adjust the <code>worldUp</code> to have it orient towards a target (leaving the <code>target</code> vector directly forward of your character) OR change how your sprite is parented/oriented</li></ul></li><li>Applying a <code>Vector3 direction</code> directly to <code>transform.</code><a class=link href=https://docs.unity3d.com/ScriptReference/Transform-forward.html target=_blank rel=noopener><code>forward</code></a>/<a class=link href=https://docs.unity3d.com/ScriptReference/Transform-up.html target=_blank rel=noopener><code>up</code></a>/<a class=link href=https://docs.unity3d.com/ScriptReference/Transform-right.html target=_blank rel=noopener><code>right</code></a><ul><li>This approach doesn&rsquo;t give control over where the other axes choose to align, so use cautiously or only in very simple cases</li></ul></li><li>Applying a <code>Quaternion rotation</code> directly to <a class=link href=https://docs.unity3d.com/ScriptReference/Transform-rotation.html target=_blank rel=noopener><code>transform.rotation</code></a> or <a class=link href=https://docs.unity3d.com/ScriptReference/Transform-localRotation.html target=_blank rel=noopener><code>transform.localRotation</code></a><ul><li>Tip: If you have <code>someRotation</code> you want to <em>apply</em> to your transform&rsquo;s orientation, <strong>don&rsquo;t do</strong> <code>transform.rotation *= someRotation;</code>! Instead, do <code>transform.rotation = someRotation * transform.rotation;</code>. Order matters</li></ul></li></ul><h3 id=quaternion-methods-youll-never-or-rarely-use><a href=#quaternion-methods-youll-never-or-rarely-use>#</a>
Quaternion Methods You&rsquo;ll Never or Rarely Use</h3><ul><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.Normalize.html target=_blank rel=noopener>Normalize</a>: Set the magnitude of a quaternion to 1, keeping its orientation. Unity does this by default in most cases</li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.Dot.html target=_blank rel=noopener>Dot</a>: Returns the Dot Product between two quaternions, a value between -1 and +1 as a measure of &ldquo;alignment&rdquo;. Easier to use Vectors</li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.Angle.html target=_blank rel=noopener>Angle</a>: Returns the angle in degrees between two quaternions. Easier to use Vectors</li><li><a class=link href=https://docs.unity3d.com/ScriptReference/Quaternion.ToAngleAxis.html target=_blank rel=noopener>ToAngleAxis</a>: Gets an Angle and Axis from a quaternion. Usually you&rsquo;re using that kind of info to create quaternions, not the other way around<ul><li>Fun fact: the axis that gets returned from <code>Quaternion.identity</code> is <code>Vector3.right</code>, or (1, 0, 0)</li></ul></li></ul><h2 id=math><a href=#math>#</a>
Math</h2><p>Quaternions consist of four numbers: <code>x</code>, <code>y</code>, <code>z</code>, and <code>w</code>*, which are all values between -1 and +1. But that still leaves us with questions:</p><ul><li>Should we try to visualize it geometrically?</li><li>What do those numbers mean?</li><li>How does multiplying with them work?</li></ul><p>*<em>Note: I&rsquo;ll be placing <code>w</code> at the end to match with Unity; other sources may put the <code>w</code> at the beginning.</em></p><h3 id=geometric-interpretation><a href=#geometric-interpretation>#</a>
Geometric Interpretation</h3><p>It can be hard for people to visualize a 4-dimensional struct. Imagine a coordinate system that consists of 4 axes. By definition, all four axes are perpendicular to each other. Oh, and three of the four axes are imaginary.</p><p>That&rsquo;s not very helpful or intuitive.</p><p>Instead, it&rsquo;s easier to imagine a quaternion in two parts: a Vector3 (using <code>x</code>, <code>y</code>, and <code>z</code>) with a certain amount of <em>spin</em> or <em>twist</em> about itself (the <code>w</code> component). This goes back to thinking in terms of Axis and Angle. The trickier part comes when trying to interpret how the <code>w</code> value relates to an actual angular value.</p><h3 id=imaginary-numbers><a href=#imaginary-numbers>#</a>
Imaginary Numbers</h3><p>The magical rotational properties stem from the usage of imaginary numbers: $i = \sqrt{-1}$</p><p>Brief refresher on the Complex Plane, $\mathbb{C}$: it&rsquo;s a 2D grid, where the horizontal axis consists of real numbers, $\mathbb{R}$, and the vertical axis consists of imaginary numbers, $\mathbb{I}$. A point in the grid is called a complex number, written as <code>a + bi</code>. Any time you multiply a complex number by <code>i</code>, it&rsquo;s like rotating that point 90° counter-clockwise about the origin. If you do that 4 times, you&rsquo;re back to where you started: <code>1</code> → <code>i</code> → <code>-1</code> → <code>-i</code> → <code>1</code></p><p>Let&rsquo;s extend the Complex Plane by adding two more imaginary dimensions: <code>j</code> and <code>k</code>. Both <code>j</code> and <code>k</code> also have the rotational superpowers that come from $\sqrt{-1}$. All four axes (<code>1</code>, <code>i</code>, <code>j</code>, and <code>k</code>) are orthogonal to one another, forming a &ldquo;basis&rdquo; in our 4D space. We can represent a quaternion in the form:</p><p>$$ x\mathbb{i} + y\mathbb{j} + z\mathbb{k} + w $$</p><p>It&rsquo;s worth pointing out that the <em>real axis</em> where <code>w</code> occupies has a unit value of <code>1</code>. It&rsquo;s just omitted in the formula for convenience: $&mldr; + w*1$. This will be useful info later when we&rsquo;re <a class=link href=#qq-multiplication>multiplying quaternions</a>.</p><p>To make sense of how multiplication with these new axes works, we need to add a few special rules. And remember: the order of multiplication <strong>matters</strong>. The value on the left is being <em>applied</em> to the one on the right:</p><ul><li><code>i * j = k</code>,  <code>j * i = -k</code></li><li><code>j * k = i</code>,  <code>k * j = -i</code></li><li><code>k * i = j</code>,  <code>i * k = -j</code><br><a class=link href=https://upload.wikimedia.org/wikipedia/commons/0/04/Cayley_Q8_quaternion_multiplication_graph.svg target=_blank rel=noopener>Click here for an interactive visualization of these rules</a></li></ul><p>Now we can make sense of what Sir Hamilton etched into stone (see quote at top of this article):</p><ul><li><code>i<sup>2</sup> = j<sup>2</sup> = k<sup>2</sup> = ijk = -1</code></li></ul><p>For that <code>ijk</code> part, whether you do the multiplication like <code>(i * j) * k</code> or <code>i * (j * k)</code>, you can use the rules to replace what&rsquo;s in the parentheses and you&rsquo;ll get <code>(k) * k = -1</code> or <code>i * (i) = -1</code>, respectively. Yay associativity!</p><h3 id=the-real-part-w><a href=#the-real-part-w>#</a>
The Real Part: w</h3><p>Since <code>w</code> is a value between -1 and +1, how can we map that from/to an angle of rotation?</p><p>Answer: $ w = \cos{(\theta / 2)} $, and $ \theta = 2 * \arccos{w} $</p><p>When <code>w</code> is 1, <code>x</code>, <code>y</code>, and <code>z</code> will be 0 due to normalization constraints. This is the same as <code>Quaternion.identity</code>, where the angle of rotation is 0°.</p><p>Although a <code>w</code> value of 0 may seem insignificant, it actually represents the <strong>most extreme rotation</strong>: 180°.</p><p>What about when <code>w</code> is -1? The other values will be forced to be 0 just as before because normalization, but the angle is actually 360°.</p><details><summary>Is this last case the same as <code>Quaternion.identity</code>?</summary><b>No.</b> When applied to a 3D model, it will <i>look</i> the exact same, the <code>Angle</code> difference between this and Identity will be 0°, but an equality check will return false. Remember: <a href=#a-complete-rotation-is-720-not-just-360>A "Complete" Rotation is 720°, Not Just 360°</a>. If you applied this <i>twice</i>, then it will be equal to the Identity. In a way, you could consider this to be the <a href=https://en.wikipedia.org/wiki/Root_of_unity target=_blank>2<sup>nd</sup> root</a> of the Identity.</details><h3 id=from-axis--angle-to-quaternion><a href=#from-axis--angle-to-quaternion>#</a>
From Axis & Angle to Quaternion</h3><p>This is to demonstrate how to do <code>var q = Quaternion.AngleAxis(angle, axis);</code> if you didn&rsquo;t have access to that Unity method</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// 1. First define your axis and your angle</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>axis</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Vector3</span><span class=p>(</span><span class=m>4f</span><span class=p>,</span> <span class=m>20f</span><span class=p>,</span> <span class=m>69f</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>angle</span> <span class=p>=</span> <span class=m>100f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 2. Get the w from the angle. Remember to convert to radians</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>w</span> <span class=p>=</span> <span class=n>Mathf</span><span class=p>.</span><span class=n>Cos</span><span class=p>(</span><span class=n>angle</span> <span class=p>*</span> <span class=n>Mathf</span><span class=p>.</span><span class=n>Deg2Rad</span> <span class=p>/</span> <span class=m>2f</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 3. Get the downscaling factor that we&#39;ll apply to the vector</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>downscale</span> <span class=p>=</span> <span class=n>Mathf</span><span class=p>.</span><span class=n>Sin</span><span class=p>(</span><span class=n>angle</span> <span class=p>*</span> <span class=n>Mathf</span><span class=p>.</span><span class=n>Deg2Rad</span> <span class=p>/</span> <span class=m>2f</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 4. Downscaling the vector ensures all 4 values combined will be normalized</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>xyz</span> <span class=p>=</span> <span class=n>axis</span><span class=p>.</span><span class=n>normalized</span> <span class=p>*</span> <span class=n>downscale</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 5. Make your Quaternion</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>q</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Quaternion</span><span class=p>(</span><span class=n>xyz</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>xyz</span><span class=p>.</span><span class=n>y</span><span class=p>,</span> <span class=n>xyz</span><span class=p>.</span><span class=n>z</span><span class=p>,</span> <span class=n>w</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=from-quaternion-to-axis--angle><a href=#from-quaternion-to-axis--angle>#</a>
From Quaternion to Axis & Angle</h3><p>This is to demonstrate how to do <code>q.ToAngleAxis(out var angle, out var axis);</code> if you didn&rsquo;t have access to that Unity method</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// 1. Assuming we already have a quaternion &#39;q&#39; defined, get the angle in degrees</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>angle</span> <span class=p>=</span> <span class=m>2f</span> <span class=p>*</span> <span class=n>Mathf</span><span class=p>.</span><span class=n>Rad2Deg</span> <span class=p>*</span> <span class=n>Mathf</span><span class=p>.</span><span class=n>Acos</span><span class=p>(</span><span class=n>q</span><span class=p>.</span><span class=n>w</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 2. Extract the vector portion. Normalize it just because</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>axis</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Vector3</span><span class=p>(</span><span class=n>q</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>q</span><span class=p>.</span><span class=n>y</span><span class=p>,</span> <span class=n>q</span><span class=p>.</span><span class=n>z</span><span class=p>).</span><span class=n>normalized</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// That&#39;s it. Return those or assign to out parameter</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=qq-multiplication><a href=#qq-multiplication>#</a>
Q*Q Multiplication</h3><p>If you know the basics of multiplication, addition, and subtraction, you can perform quaternion multiplication!</p><p>Since we know the form of a quaternion, and we&rsquo;re only plugging in the values for <code>x</code>, <code>y</code>, <code>z</code>, and <code>w</code>, we can set up a multiplication table for the axes and use the special rules from earlier to simplify the math:</p><div class=table-wrapper><table><thead><tr><th></th><th style=text-align:center><code>i</code></th><th style=text-align:center><code>j</code></th><th style=text-align:center><code>k</code></th><th style=text-align:center><code>1</code></th></tr></thead><tbody><tr><td><code>i</code></td><td style=text-align:center>-1</td><td style=text-align:center>k</td><td style=text-align:center>-j</td><td style=text-align:center>i</td></tr><tr><td><code>j</code></td><td style=text-align:center>-k</td><td style=text-align:center>-1</td><td style=text-align:center>i</td><td style=text-align:center>j</td></tr><tr><td><code>k</code></td><td style=text-align:center>j</td><td style=text-align:center>-i</td><td style=text-align:center>-1</td><td style=text-align:center>k</td></tr><tr><td><code>1</code></td><td style=text-align:center>i</td><td style=text-align:center>j</td><td style=text-align:center>k</td><td style=text-align:center>1</td></tr></tbody></table></div><p>For <code>Q<sub>A</sub> * Q<sub>B</sub></code>, <code>Q<sub>A</sub></code> would be along the left column, and <code>Q<sub>B</sub></code> would be along the top row. If you swap them, you&rsquo;ll just have some minus signs in the wrong spots.</p><p><b>Step-by-Step Example</b></p><p>In this example, imagine we&rsquo;re looking at a computer monitor slightly to our right at 30° and want to turn our neck left by 120°.<br><code>Q<sub>A</sub> = 0i - 0.866j + 0k + 0.5</code> ← rotation same as <code>Quaternion.AngleAxis(-120f, Vector3.up)</code><br><code>Q<sub>B</sub> = 0i + 0.2588j + 0k + 0.9659</code> ← orientation same as <code>Quaternion.AngleAxis(30, Vector3.up)</code><br>Use a matrix table to perform <code>Q<sub>A</sub> * Q<sub>B</sub></code></p><div class=table-wrapper><table><thead><tr><th></th><th style=text-align:center><code>0 i</code></th><th style=text-align:center><code>0.2588 j</code></th><th style=text-align:center><code>0 k</code></th><th style=text-align:center><code>0.9659</code></th></tr></thead><tbody><tr><td><code>0 i</code></td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr><tr><td><code>-0.866 j</code></td><td style=text-align:center>0</td><td style=text-align:center>0.22414</td><td style=text-align:center>0</td><td style=text-align:center>-0.8365 j</td></tr><tr><td><code>0 k</code></td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr><tr><td><code>0.5</code></td><td style=text-align:center>0</td><td style=text-align:center>0.1294 j</td><td style=text-align:center>0</td><td style=text-align:center>0.48296</td></tr></tbody></table></div><p>Combinining like terms gives us: <code>Q<sub>B</sub>&rsquo; = 0i - 0.7071j + 0k + 0.7071</code></p><p>Converting that <a class=link href=#from-quaternion-to-axis--angle>quaternion to an Angle and Axis</a> tells us it&rsquo;s a 90° rotation about the negative Y-axis. Using the left-hand-rule, this orientation represents looking directly left. We did it! That wasn&rsquo;t too bad.</p><h3 id=qv-multiplication><a href=#qv-multiplication>#</a>
Q*V Multiplication</h3><p>I know I wrote <code>Q * V</code>, but <em>actually</em> we have to do <code>Q * V * Q<sup>-1</sup></code>, <em>sandwiching</em> the vector between the quaterion and its inverse*. Yummy. This is to ensure the <code>w</code> value gets properly canceled out so that we&rsquo;re left with a Vector in the end and not actually a quaternion.</p><p>*<i>Note: In Unity, you can&rsquo;t perform <code>V * Q</code> in that order. This math section is how to solve it <strong>on paper</strong>, and it&rsquo;s more-or-less what happens behind the scenes when you do a <code>Q * V</code> operation in Unity.</i></p><p>Not the best analogy, but here&rsquo;s one way to think about it the sandwiching: Imagine wringing out a wet towel. Both hands start facing the same direction as each other, palms down gripping the towel. One hand twists the towel in one direction 180° (<code>Q</code>). The other hand twists it 180° in the opposite direction (<code>Q<sup>-1</sup></code>). Both hands end up still facing the same way as each other, but the towel (<code>V</code>) ends up twisted (rotated) and slightly less soaked.</p><p>So how do we multiply something that lives in 3D space by something that&rsquo;s 4D? They live in very different spaces - real world vs complex imaginary land. <strong>Here&rsquo;s the trick</strong>:</p><ol><li>We <em>pretend</em> our vector is actually 4D like a quaternion, setting the <code>w</code> value to 0. We don&rsquo;t do any normalzing to it. We&rsquo;ll call it <code>V<sub>4D</sub></code></li><li>We do the same quaternion multiplication as before but just <strong>twice</strong>. It doesn&rsquo;t matter which pair you multiply first: <code>(Q * V<sub>4D</sub>) * Q<sup>-1</sup></code> = <code>Q * (V<sub>4D</sub> * Q<sup>-1</sup>)</code></li><li>After all the multiplication math dust settles, if we did it right, its <code>w</code> will end up as 0 and so we drop that real axis. We also drop the imaginary labels <code>i</code>, <code>j</code>, and <code>k</code> from it to convert it back to a regular Vector, now rotated</li></ol><p><strong>Longer Step-by-Step Example</strong></p><p>In this example, let&rsquo;s start with a <code>(7, 7, 0)</code> vector and try to rotate that counter-clockwise by 45°. Relatively simple 2D example that you could solve using the <a class=link href=https://en.wikipedia.org/wiki/Rotation_matrix target=_blank rel=noopener>Rotation Matrix</a>, but let&rsquo;s demonstrate what it looks like with quaternions<br><code>V = 7x + 7y + 0z</code><br><code>Q = 0i + 0j + 0.38268k + 0.92388</code> ← rotation same as <code>Quaternion.AngleAxis(45f, Vector3.forward)</code><br><code>Q<sup>-1</sup> = 0i + 0j - 0.38268k + 0.92388</code> ← Inverse to sandwich with<br>Let&rsquo;s pretend that V is a quaternion. I&rsquo;m choosing to perform <code>V<sub>4D</sub> * Q<sup>-1</sup></code> first</p><div class=table-wrapper><table><thead><tr><th></th><th style=text-align:center><code>0 i</code></th><th style=text-align:center><code>0 j</code></th><th style=text-align:center><code>-0.38268 k</code></th><th style=text-align:center><code>0.92388</code></th></tr></thead><tbody><tr><td><code>7 i</code></td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>2.67876 j</td><td style=text-align:center>6.46716 i</td></tr><tr><td><code>7 j</code></td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>-2.67876 i</td><td style=text-align:center>6.46716 j</td></tr><tr><td><code>0 k</code></td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr><tr><td><code>0</code></td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr></tbody></table></div><p>Combinining like terms gives us <code>V<sub>4D</sub>&rsquo; = 3.7884i + 9.14592j + 0k + 0</code></p><p>Half-way there. Now we multiply <code>Q * V<sub>4D</sub>&rsquo;</code></p><div class=table-wrapper><table><thead><tr><th></th><th style=text-align:center><code>3.7884 i</code></th><th style=text-align:center><code>9.14592 j</code></th><th style=text-align:center><code>0 k</code></th><th style=text-align:center><code>0</code></th></tr></thead><tbody><tr><td><code>0 i</code></td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr><tr><td><code>0 j</code></td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr><tr><td><code>0.38268 k</code></td><td style=text-align:center>1.45 j</td><td style=text-align:center>-3.5 i</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr><tr><td><code>0.92388</code></td><td style=text-align:center>3.5 i</td><td style=text-align:center>8.45 j</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr></tbody></table></div><p>Simplifying one last time gives us <code>V<sub>4D</sub>&rsquo; = 0i + 9.9j + 0k + 0</code></p><p>Converting the final result back into 3D world space gives us a vector of <code>(0, 9.9, 0)</code>. Awesome!</p><h2 id=conclusion><a href=#conclusion>#</a>
Conclusion</h2><p>Visualizing the rotations and getting a solid point of reference (local, global, relative to something else?) can be daunting. But now you know the essentials and to think about them in terms of and <strong>axis</strong> and an <strong>angle</strong>, so go out there and practice with them! Think about what sort of scenarios would be suitable for different methods. Don&rsquo;t multiply them in the wrong order. Level up beyond the pedestrian Euler angles. Being able to use Quaternions is an invaluable tool to have as a gamedev. And they&rsquo;re pretty nifty too &#x1f44d;</p><h2 id=bonus-material-and-resources><a href=#bonus-material-and-resources>#</a>
Bonus Material and Resources</h2><h3 id=faq><a href=#faq>#</a>
FAQ</h3><details><summary>I want to interpolate between a start and end orientation, but with the <b>long/outer</b> path. How can I achieve this?</summary>As with anything program-related, there are lots of potential solutions. Here is one approach using <code>SlerpUnclamped</code>:<pre><code>public Quaternion SlerpLongPath(Quaternion from, Quaternion to, float t)
{
    var angle = Quaternion.Angle(from, to); // angle along short path
    if (angle == 0) return from; // avoid divide-by-zero
    float adjustedT = t * (angle - 360f) / angle; // remaps t from [0,1] to [0,-N]
    return Quaternion.SlerpUnclamped(from, to, adjustedT);
}
</code></pre><details><summary>Pop Quiz: In what situation will the above code <b>not</b> give desired results?</summary>Answer: When the Angle between <code>from</code> and <code>to</code> is less than ~36°. See <a href=#quaternion-interpolation>Quaternion Interpolation</a> for details</details>If that's going to be a problem, here is a different approach that uses a mid-point that we flip around:<pre><code>public Quaternion SlerpLongPath(Quaternion from, Quaternion to, float t)
{
    var midRot = Quaternion.Slerp(from, to, 0.5f); // orientation along short path
    midRot.ToAngleAxis(out var midAngle, out var midAxis); // niche use for this method
    var midRotLong = Quaternion.AngleAxis(midAngle + 180f, midAxis); // opposite dir of short path
    if (t < 0.5f) return Quaternion.Slerp(from, midRotLong, 2 * t);
    return Quaternion.Slerp(midRotLong, to, 2 * t - 1);
}
</code></pre>With this approach, if <code>from</code> and <code>to</code> are identical or exactly 180° apart, the long path is not strongly defined so results may vary</details><h3 id=videos><a href=#videos>#</a>
Videos</h3><ul><li><a class=link href="https://www.youtube.com/watch?v=d4EgbgTm0Bg" target=_blank rel=noopener><em>Visualizing quaternions</em></a> (31:50) - 3Blue1Brown, part 1</li><li><a class=link href="https://www.youtube.com/watch?v=zjMuIxRvygQ" target=_blank rel=noopener><em>Quaternions and 3d rotation</em></a> (5:58) - 3Blue1Brown, part 2</li><li><a class=link href="https://www.youtube.com/watch?v=jTgdKoQv738" target=_blank rel=noopener><em>How quaternions produce 3D rotation</em></a> (11:34) - PenguinMaths</li></ul><h3 id=reading><a href=#reading>#</a>
Reading</h3><ul><li><a class=link href=https://penguinmaths.blogspot.com/2019/06/how-quaternions-produce-3d-rotation.html target=_blank rel=noopener><em>How Quaternions Produce 3D Rotations</em></a> - PenguinMaths</li><li><a class=link href=https://docs.unity3d.com/Manual/QuaternionAndEulerRotationsInUnity.html target=_blank rel=noopener><em>Rotation and orientation in Unity</em></a> - Unity Docs. Short &rsquo;n sweet</li><li><a class=link href=https://en.wikipedia.org/wiki/Quaternion target=_blank rel=noopener><em>Quaternion</em></a> - Wikipedia</li></ul><h3 id=further-reading><a href=#further-reading>#</a>
Further Reading</h3><ul><li><a class=link href=https://marctenbosch.com/quaternions/ target=_blank rel=noopener><em>Let&rsquo;s remove Quaternions from every 3D Engine</em></a> - Marc ten Bosch. Interesting read. Suggests Rotors</li><li><a class=link href=https://en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles target=_blank rel=noopener><em>Conversion between quaternions and Euler angles</em></a> - Wikipedia. Did not cover this. Heavy math</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/math/>Math</a>
<a href=/tags/c%23/>C#</a>
<a href=/tags/unity/>Unity</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/naming-conventions/><div class=article-image><img src=/p/naming-conventions/code_quality.5cc6f11b34bf42fe3e1c97676aefd6f3_hue10b4217b2057d588cfa8463f7032127_80020_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post Naming Conventions" data-hash="md5-XMbxGzS/Qv4+HJdnau/W8w=="></div><div class=article-details><h2 class=article-title>Naming Conventions</h2></div></a></article><article><a href=/p/roll-a-tetrahedron/><div class=article-details><h2 class=article-title>Roll-A-Tetrahedron</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//libberator-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2024 Libbs' Lab</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.25.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>